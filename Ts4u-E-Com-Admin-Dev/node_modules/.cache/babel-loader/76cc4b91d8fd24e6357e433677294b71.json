{"ast":null,"code":"import _classCallCheck from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Spin}from'antd';import Cookies from\"js-cookie\";import axios from\"axios\";import store from\"../store/index\";var configureAxiosHeader=function configureAxiosHeader(){axios.defaults.baseURL=process.env.REACT_APP_API;var token=Cookies.get(\"ecom\");axios.defaults.headers.common={Authorization:token};};var withAuth=function withAuth(AuthComponent){return/*#__PURE__*/function(_Component){_inherits(Authenticated,_Component);var _super=_createSuper(Authenticated);function Authenticated(props){var _this;_classCallCheck(this,Authenticated);_this=_super.call(this,props);_this.state={isLoading:true,userData:[]};return _this;}_createClass(Authenticated,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;configureAxiosHeader();var token=Cookies.get(\"ecom\");if(token){this.setState({isLoading:true});axios.post(\"\".concat(process.env.REACT_APP_API,\"/user/verify\"),{}).then(function(res){if(res.status===200&&res.data.success){//do some change state\n_this2.setState({userData:res.data.user});_this2.setState({isLoading:false});store.dispatch({type:\"SET_USER\",payload:res.data.user});}}).catch(function(err){_this2.setState({isLoading:false});Cookies.remove(\"ecom\");console.log(err.message);store.dispatch({type:\"LOGOUT\"});if(window.location.pathname!=='/login'){window.location.pathname='/login';}});}else{this.setState({isLoading:false});if(window.location.pathname!=='/login'){if(window.location.pathname==='/register'){return;}else{window.location.pathname='/login';}}}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",{style:{height:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\"}},/*#__PURE__*/React.createElement(Spin,{size:'large'})):/*#__PURE__*/React.createElement(AuthComponent,Object.assign({},this.props,{userData:this.state.userData})));}}]);return Authenticated;}(Component);};export default withAuth;","map":{"version":3,"sources":["/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/withAuth/withAuth.js"],"names":["React","Component","Spin","Cookies","axios","store","configureAxiosHeader","defaults","baseURL","process","env","REACT_APP_API","token","get","headers","common","Authorization","withAuth","AuthComponent","props","state","isLoading","userData","setState","post","then","res","status","data","success","user","dispatch","type","payload","catch","err","remove","console","log","message","window","location","pathname","height","display","justifyContent","alignItems"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Spin } from 'antd';\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\n\nimport store from \"../store/index\";\n\nconst configureAxiosHeader = () => {\n    axios.defaults.baseURL = process.env.REACT_APP_API\n  const token = Cookies.get(\"ecom\");\n  axios.defaults.headers.common = {\n    Authorization: token,\n  };\n};\n\nconst withAuth = (AuthComponent) => {\n  return class Authenticated extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        isLoading: true,\n        userData: [],\n      };\n    }\n\n    componentDidMount() {\n     \n      configureAxiosHeader();\n      const token = Cookies.get(\"ecom\");\n      if(token){\n\n        this.setState({ isLoading: true });\n        axios\n          .post(`${process.env.REACT_APP_API}/user/verify`, {})\n          .then((res) => {\n            if (res.status === 200 && res.data.success) {\n              //do some change state\n              this.setState({ userData: res.data.user });\n              this.setState({ isLoading: false });\n              store.dispatch({\n                  type:\"SET_USER\",\n                  payload:res.data.user\n              })\n            }\n          })\n          .catch((err) => {\n              this.setState({ isLoading: false });\n            Cookies.remove(\"ecom\");\n            console.log(err.message);\n            store.dispatch({\n                type:\"LOGOUT\"\n            })\n            if(window.location.pathname !== '/login'){\n             \n                window.location.pathname='/login'\n\n            }\n            \n          });\n      }else{\n        this.setState({ isLoading: false });\n  \n        if(window.location.pathname !== '/login'){\n            if(window.location.pathname === '/register'){\n             return\n            }else{\n              window.location.pathname='/login'\n            }\n         \n        }\n      }\n     \n    }\n\n    render() {\n      return (\n        <div>\n          {this.state.isLoading ? (\n            <div style={{height:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\"}}><Spin size={'large'}/></div>\n          ) : (\n            <AuthComponent {...this.props} userData={this.state.userData} />\n          )}\n        </div>\n      );\n    }\n  };\n};\nexport default withAuth;\n"]},"metadata":{},"sourceType":"module"}