{"ast":null,"code":"import _objectSpread from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _toConsumableArray from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Select,Col,Card,Input,Button,Table,Tag,Space,Image,Switch,Popconfirm,Modal,DatePicker}from'antd';import axios from'axios';import{useParams}from'react-router-dom';var Option=Select.Option;function AddToCamp(_ref){var params=_ref.params,isModalVisible=_ref.isModalVisible,handleOk=_ref.handleOk,handleCancel=_ref.handleCancel,sendProduct=_ref.sendProduct;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),products=_useState2[0],setProducts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),categories=_useState4[0],setCategories=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),subCategories=_useState6[0],setSubCategories=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setCategory=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),subCategory=_useState10[0],setSubCategory=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),brands=_useState12[0],setBrands=_useState12[1];var _useState13=useState(''),_useState14=_slicedToArray(_useState13,2),brand=_useState14[0],setBrand=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),selectedRowKeys=_useState16[0],setSelectedRowKeys=_useState16[1];var _useState17=useState([]),_useState18=_slicedToArray(_useState17,2),selectedRows=_useState18[0],setSelectedRows=_useState18[1];var fetchCategories=function fetchCategories(){axios.get(\"/category/getcategory\").then(function(res){setCategories(res.data.categories);}).catch(function(err){console.log(err);});};var fetchBrands=function fetchBrands(){axios.get('/brand/get').then(function(res){// console.log(res.data.brands);\nsetBrands(res.data.brands);}).catch(function(err){err&&err.response&&console.log(err.response.data);});};var fetchProducts=function fetchProducts(){axios.get('/campaign/getproductstoselect/'+params.campaignid).then(function(res){setProducts(res.data.products);}).catch(function(err){err&&err.response&&console.log(err.response.data);});};useEffect(function(){//fetchCategories()\n//fetchBrands()\nfetchProducts();},[isModalVisible]);//category actions\nuseEffect(function(){if(category){var _filterd$;var filterd=categories.filter(function(cat){return cat._id===category;});setSubCategories((_filterd$=filterd[0])===null||_filterd$===void 0?void 0:_filterd$.children);setSubCategory('');}else{setSubCategories([]);setSubCategory('');}},[category]);var rowSelection={selectedRowKeys:selectedRowKeys,onChange:function onChange(selectedRowKeys,selectedRows){setSelectedRowKeys(selectedRowKeys);setSelectedRows(selectedRows);}};var handleColumnValue=function handleColumnValue(value,_id,type){if(type==='discountvalue'){var selected=_toConsumableArray(selectedRows);var index=selected.findIndex(function(r){return r._id===_id;});selected[index]=_objectSpread(_objectSpread({},selected[index]),{},{campDiscountValue:value});setSelectedRows(selected);}if(type==='discounttype'){var _selected=_toConsumableArray(selectedRows);var _index=_selected.findIndex(function(r){return r._id===_id;});_selected[_index]=_objectSpread(_objectSpread({},_selected[_index]),{},{campDiscountType:value});setSelectedRows(_selected);}};// console.log(selectedRows);\nvar columns=[{title:'Name',dataIndex:'name',render:function render(text){return/*#__PURE__*/React.createElement(\"a\",null,text);}},{title:'Thumbnail',key:'thumbnail',dataIndex:'thumbnail',render:function render(thumbnail){return/*#__PURE__*/React.createElement(Image,{width:30,src:thumbnail,fallback:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMIAAADDCAYAAADQvc6UAAABRWlDQ1BJQ0MgUHJvZmlsZQAAKJFjYGASSSwoyGFhYGDIzSspCnJ3UoiIjFJgf8LAwSDCIMogwMCcmFxc4BgQ4ANUwgCjUcG3awyMIPqyLsis7PPOq3QdDFcvjV3jOD1boQVTPQrgSkktTgbSf4A4LbmgqISBgTEFyFYuLykAsTuAbJEioKOA7DkgdjqEvQHEToKwj4DVhAQ5A9k3gGyB5IxEoBmML4BsnSQk8XQkNtReEOBxcfXxUQg1Mjc0dyHgXNJBSWpFCYh2zi+oLMpMzyhRcASGUqqCZ16yno6CkYGRAQMDKMwhqj/fAIcloxgHQqxAjIHBEugw5sUIsSQpBobtQPdLciLEVJYzMPBHMDBsayhILEqEO4DxG0txmrERhM29nYGBddr//5/DGRjYNRkY/l7////39v///y4Dmn+LgeHANwDrkl1AuO+pmgAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAwqADAAQAAAABAAAAwwAAAAD9b/HnAAAHlklEQVR4Ae3dP3PTWBSGcbGzM6GCKqlIBRV0dHRJFarQ0eUT8LH4BnRU0NHR0UEFVdIlFRV7TzRksomPY8uykTk/zewQfKw/9znv4yvJynLv4uLiV2dBoDiBf4qP3/ARuCRABEFAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghggQAQZQKAnYEaQBAQaASKIAQJEkAEEegJmBElAoBEgghgg0Aj8i0JO4OzsrPv69Wv+hi2qPHr0qNvf39+iI97soRIh4f3z58/u7du3SXX7Xt7Z2enevHmzfQe+oSN2apSAPj09TSrb+XKI/f379+08+A0cNRE2ANkupk+ACNPvkSPcAAEibACyXUyfABGm3yNHuAECRNgAZLuYPgEirKlHu7u7XdyytGwHAd8jjNyng4OD7vnz51dbPT8/7z58+NB9+/bt6jU/TI+AGWHEnrx48eJ/EsSmHzx40L18+fLyzxF3ZVMjEyDCiEDjMYZZS5wiPXnyZFbJaxMhQIQRGzHvWR7XCyOCXsOmiDAi1HmPMMQjDpbpEiDCiL358eNHurW/5SnWdIBbXiDCiA38/Pnzrce2YyZ4//59F3ePLNMl4PbpiL2J0L979+7yDtHDhw8vtzzvdGnEXdvUigSIsCLAWavHp/+qM0BcXMd/q25n1vF57TYBp0a3mUzilePj4+7k5KSLb6gt6ydAhPUzXnoPR0dHl79WGTNCfBnn1uvSCJdegQhLI1vvCk+fPu2ePXt2tZOYEV6/fn31dz+shwAR1sP1cqvLntbEN9MxA9xcYjsxS1jWR4AIa2Ibzx0tc44fYX/16lV6NDFLXH+YL32jwiACRBiEbf5KcXoTIsQSpzXx4N28Ja4BQoK7rgXiydbHjx/P25TaQAJEGAguWy0+2Q8PD6/Ki4R8EVl+bzBOnZY95fq9rj9zAkTI2SxdidBHqG9+skdw43borCXO/ZcJdraPWdv22uIEiLA4q7nvvCug8WTqzQveOH26fodo7g6uFe/a17W3+nFBAkRYENRdb1vkkz1CH9cPsVy/jrhr27PqMYvENYNlHAIesRiBYwRy0V+8iXP8+/fvX11Mr7L7ECueb/r48eMqm7FuI2BGWDEG8cm+7G3NEOfmdcTQw4h9/55lhm7DekRYKQPZF2ArbXTAyu4kDYB2YxUzwg0gi/41ztHnfQG26HbGel/crVrm7tNY+/1btkOEAZ2M05r4FB7r9GbAIdxaZYrHdOsgJ/wCEQY0J74TmOKnbxxT9n3FgGGWWsVdowHtjt9Nnvf7yQM2aZU/TIAIAxrw6dOnAWtZZcoEnBpNuTuObWMEiLAx1HY0ZQJEmHJ3HNvGCBBhY6jtaMoEiJB0Z29vL6ls58vxPcO8/zfrdo5qvKO+d3Fx8Wu8zf1dW4p/cPzLly/dtv9Ts/EbcvGAHhHyfBIhZ6NSiIBTo0LNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiECRCjUbEPNCRAhZ6NSiAARCjXbUHMCRMjZqBQiQIRCzTbUnAARcjYqhQgQoVCzDTUnQIScjUohAkQo1GxDzQkQIWejUogAEQo121BzAkTI2agUIkCEQs021JwAEXI2KoUIEKFQsw01J0CEnI1KIQJEKNRsQ80JECFno1KIABEKNdtQcwJEyNmoFCJAhELNNtScABFyNiqFCBChULMNNSdAhJyNSiEC/wGgKKC4YMA4TAAAAABJRU5ErkJggg==\"});}},{title:'price',dataIndex:'price',key:'price',render:function render(price){return/*#__PURE__*/React.createElement(\"span\",null,\"$ \",price);}},{title:'Previous Discount',key:'discount',dataIndex:'discount',render:function render(discount){return discount.value>0?discount.discountType==='flat'?/*#__PURE__*/React.createElement(\"span\",{className:\"new-price\"},\"$ \",discount.value):/*#__PURE__*/React.createElement(\"span\",{className:\"new-price\"},discount.value,\" %\"):/*#__PURE__*/React.createElement(\"span\",null,\"$ 0\");}},{title:'Campaign Discount',dataIndex:'_id',key:'_id',render:function render(_id){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Input,{defaultValue:0,style:{width:\"50%\",marginRight:\"10px\"},onChange:function onChange(e){return handleColumnValue(e.target.value,_id,\"discountvalue\");},type:\"number\",disabled:!selectedRowKeys.includes(_id)}),/*#__PURE__*/React.createElement(Select,{dropdownStyle:{zIndex:\"1111\"},style:{width:\"45%\"},placeholder:\"Select discount type\",onChange:function onChange(value){return handleColumnValue(value,_id,\"discounttype\");},defaultValue:'flat'//value={discountType}\n,disabled:!selectedRowKeys.includes(_id)},/*#__PURE__*/React.createElement(Option,{value:\"flat\"},\"Flat\"),/*#__PURE__*/React.createElement(Option,{value:\"percent\"},\"Percent\")));}}];var addToCamp=function addToCamp(){var campaignId=params.campaignid;selectedRows.map(function(rows){var data={campaignId:campaignId,productId:rows._id,value:rows.campDiscountValue,discountType:rows.campDiscountType};axios.patch(\"/campaign/addproducttocampaign\",data).then(function(res){sendProduct(res.data.product);setProducts(function(prev){return prev.filter(function(prod){return prod._id!==res.data.product._id;});});setSelectedRows(function(prev){return prev.filter(function(prod){return prod._id!==res.data.product._id;});});setSelectedRowKeys(function(prev){return prev.filter(function(_id){return _id!==res.data.product._id;});});}).catch(function(err){err&&err.response&&console.log(err.response.data);});});};return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{zIndex:1111,title:\"Basic Modal\",visible:isModalVisible,onOk:handleOk,onCancel:handleCancel,width:1000,style:{top:\"10px\"},bodyStyle:{overflow:\"auto\",height:\"80vh\"},footer:[/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return handleCancel();},className:\"submit_btn\",type:\"primary\",danger:true},\"Cancel\"))]},/*#__PURE__*/React.createElement(\"div\",{className:\"campaign_wrapper\"},/*#__PURE__*/React.createElement(Button,{onClick:function onClick(){return addToCamp();},disabled:selectedRows.length===0,type:\"primary\"},\"Add to campaign\"),selectedRows.length>0&&/*#__PURE__*/React.createElement(\"strong\",{style:{marginLeft:\"10px\"}},selectedRows.length,\" products seleted\"),/*#__PURE__*/React.createElement(Table,{rowSelection:rowSelection,columns:columns,dataSource:products,rowKey:\"_id\"}))));}export default AddToCamp;","map":{"version":3,"sources":["/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/pages/campaigns/AddToCamp.js"],"names":["React","useState","useEffect","Select","Col","Card","Input","Button","Table","Tag","Space","Image","Switch","Popconfirm","Modal","DatePicker","axios","useParams","Option","AddToCamp","params","isModalVisible","handleOk","handleCancel","sendProduct","products","setProducts","categories","setCategories","subCategories","setSubCategories","category","setCategory","subCategory","setSubCategory","brands","setBrands","brand","setBrand","selectedRowKeys","setSelectedRowKeys","selectedRows","setSelectedRows","fetchCategories","get","then","res","data","catch","err","console","log","fetchBrands","response","fetchProducts","campaignid","filterd","filter","cat","_id","children","rowSelection","onChange","handleColumnValue","value","type","selected","index","findIndex","r","campDiscountValue","campDiscountType","columns","title","dataIndex","render","text","key","thumbnail","price","discount","discountType","width","marginRight","e","target","includes","zIndex","addToCamp","campaignId","map","rows","productId","patch","product","prev","prod","top","overflow","height","length","marginLeft"],"mappings":"ukBAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,MAAT,CAAiBC,GAAjB,CAAsBC,IAAtB,CAA4BC,KAA5B,CAAmCC,MAAnC,CAA2CC,KAA3C,CAAkDC,GAAlD,CAAuDC,KAAvD,CAA8DC,KAA9D,CAAqEC,MAArE,CAA6EC,UAA7E,CAAyFC,KAAzF,CAAgGC,UAAhG,KAAkH,MAAlH,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,SAAT,KAA0B,kBAA1B,CACA,GAAQC,CAAAA,MAAR,CAAmBf,MAAnB,CAAQe,MAAR,CAIA,QAASC,CAAAA,SAAT,MAA8E,IAA1DC,CAAAA,MAA0D,MAA1DA,MAA0D,CAAnDC,cAAmD,MAAnDA,cAAmD,CAApCC,QAAoC,MAApCA,QAAoC,CAA3BC,YAA2B,MAA3BA,YAA2B,CAAdC,WAAc,MAAdA,WAAc,CAG1E,cAAgCvB,QAAQ,CAAC,EAAD,CAAxC,wCAAOwB,QAAP,eAAiBC,WAAjB,eAGA,eAAoCzB,QAAQ,CAAC,EAAD,CAA5C,yCAAO0B,UAAP,eAAmBC,aAAnB,eACA,eAA0C3B,QAAQ,CAAC,EAAD,CAAlD,yCAAO4B,aAAP,eAAsBC,gBAAtB,eACA,eAAgC7B,QAAQ,CAAC,EAAD,CAAxC,yCAAO8B,QAAP,eAAiBC,WAAjB,eACA,eAAsC/B,QAAQ,CAAC,EAAD,CAA9C,0CAAOgC,WAAP,gBAAoBC,cAApB,gBACA,gBAA4BjC,QAAQ,CAAC,EAAD,CAApC,2CAAOkC,MAAP,gBAAeC,SAAf,gBACA,gBAA0BnC,QAAQ,CAAC,EAAD,CAAlC,2CAAOoC,KAAP,gBAAcC,QAAd,gBACA,gBAA8CrC,QAAQ,CAAC,EAAD,CAAtD,2CAAOsC,eAAP,gBAAwBC,kBAAxB,gBACA,gBAAwCvC,QAAQ,CAAC,EAAD,CAAhD,2CAAOwC,YAAP,gBAAqBC,eAArB,gBAEA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC1B3B,KAAK,CAAC4B,GAAN,CAAU,uBAAV,EACKC,IADL,CACU,SAAAC,GAAG,CAAI,CACTlB,aAAa,CAACkB,GAAG,CAACC,IAAJ,CAASpB,UAAV,CAAb,CACH,CAHL,EAIKqB,KAJL,CAIW,SAAAC,GAAG,CAAI,CACVC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACH,CANL,EAOH,CARD,CAUA,GAAMG,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,EAAM,CACtBpC,KAAK,CAAC4B,GAAN,CAAU,YAAV,EACKC,IADL,CACU,SAAAC,GAAG,CAAI,CACT;AACAV,SAAS,CAACU,GAAG,CAACC,IAAJ,CAASZ,MAAV,CAAT,CACH,CAJL,EAKKa,KALL,CAKW,SAAAC,GAAG,CAAI,CACVA,GAAG,EAAIA,GAAG,CAACI,QAAX,EAAuBH,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACI,QAAJ,CAAaN,IAAzB,CAAvB,CACH,CAPL,EAQH,CATD,CAWA,GAAMO,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CACxBtC,KAAK,CAAC4B,GAAN,CAAU,iCAAiCxB,MAAM,CAACmC,UAAlD,EACKV,IADL,CACU,SAAAC,GAAG,CAAI,CACTpB,WAAW,CAACoB,GAAG,CAACC,IAAJ,CAAStB,QAAV,CAAX,CACH,CAHL,EAIKuB,KAJL,CAIW,SAAAC,GAAG,CAAI,CACVA,GAAG,EAAIA,GAAG,CAACI,QAAX,EAAuBH,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACI,QAAJ,CAAaN,IAAzB,CAAvB,CACH,CANL,EAOH,CARD,CAWA7C,SAAS,CAAC,UAAM,CACZ;AACA;AACAoD,aAAa,GAChB,CAJQ,CAIN,CAACjC,cAAD,CAJM,CAAT,CAMA;AACAnB,SAAS,CAAC,UAAM,CACZ,GAAI6B,QAAJ,CAAc,eACV,GAAIyB,CAAAA,OAAO,CAAG7B,UAAU,CAAC8B,MAAX,CAAkB,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,GAAJ,GAAY5B,QAAhB,EAArB,CAAd,CACAD,gBAAgB,YAAC0B,OAAO,CAAC,CAAD,CAAR,oCAAC,UAAYI,QAAb,CAAhB,CACA1B,cAAc,CAAC,EAAD,CAAd,CAEH,CALD,IAKO,CACHJ,gBAAgB,CAAC,EAAD,CAAhB,CACAI,cAAc,CAAC,EAAD,CAAd,CAEH,CACJ,CAXQ,CAWN,CAACH,QAAD,CAXM,CAAT,CAgBA,GAAM8B,CAAAA,YAAY,CAAG,CACjBtB,eAAe,CAAfA,eADiB,CAEjBuB,QAAQ,CAAE,kBAACvB,eAAD,CAAkBE,YAAlB,CAAmC,CAEzCD,kBAAkB,CAACD,eAAD,CAAlB,CACAG,eAAe,CAACD,YAAD,CAAf,CACH,CANgB,CAArB,CAaA,GAAMsB,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,KAAD,CAAQL,GAAR,CAAaM,IAAb,CAAsB,CAE5C,GAAIA,IAAI,GAAK,eAAb,CAA8B,CAC1B,GAAIC,CAAAA,QAAQ,oBAAOzB,YAAP,CAAZ,CACA,GAAI0B,CAAAA,KAAK,CAAGD,QAAQ,CAACE,SAAT,CAAmB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACV,GAAF,GAAUA,GAAd,EAApB,CAAZ,CACAO,QAAQ,CAACC,KAAD,CAAR,gCAAuBD,QAAQ,CAACC,KAAD,CAA/B,MAAwCG,iBAAiB,CAAEN,KAA3D,GACAtB,eAAe,CAACwB,QAAD,CAAf,CACH,CACD,GAAID,IAAI,GAAK,cAAb,CAA6B,CACzB,GAAIC,CAAAA,SAAQ,oBAAOzB,YAAP,CAAZ,CACA,GAAI0B,CAAAA,MAAK,CAAGD,SAAQ,CAACE,SAAT,CAAmB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACV,GAAF,GAAUA,GAAd,EAApB,CAAZ,CACAO,SAAQ,CAACC,MAAD,CAAR,gCAAuBD,SAAQ,CAACC,MAAD,CAA/B,MAAwCI,gBAAgB,CAAEP,KAA1D,GACAtB,eAAe,CAACwB,SAAD,CAAf,CACH,CACJ,CAdD,CAgBD;AAIC,GAAMM,CAAAA,OAAO,CAAG,CACZ,CACIC,KAAK,CAAE,MADX,CAEIC,SAAS,CAAE,MAFf,CAGIC,MAAM,CAAE,gBAACC,IAAD,qBAAU,6BAAIA,IAAJ,CAAV,EAHZ,CADY,CAMZ,CACIH,KAAK,CAAE,WADX,CAEII,GAAG,CAAE,WAFT,CAGIH,SAAS,CAAE,WAHf,CAIIC,MAAM,CAAE,gBAAAG,SAAS,qBAAI,oBAAC,KAAD,EACjB,KAAK,CAAE,EADU,CAEjB,GAAG,CAAEA,SAFY,CAGjB,QAAQ,CAAC,gqGAHQ,EAAJ,EAJrB,CANY,CAgBZ,CACIL,KAAK,CAAE,OADX,CAEIC,SAAS,CAAE,OAFf,CAGIG,GAAG,CAAE,OAHT,CAIIF,MAAM,CAAE,gBAAAI,KAAK,qBACT,qCAASA,KAAT,CADS,EAJjB,CAhBY,CAwBZ,CACIN,KAAK,CAAE,mBADX,CAEII,GAAG,CAAE,UAFT,CAGIH,SAAS,CAAE,UAHf,CAIIC,MAAM,CAAE,gBAACK,QAAD,QACJA,CAAAA,QAAQ,CAAChB,KAAT,CAAiB,CAAjB,CACIgB,QAAQ,CAACC,YAAT,GAA0B,MAA1B,cACI,4BAAM,SAAS,CAAC,WAAhB,OAA+BD,QAAQ,CAAChB,KAAxC,CADJ,cAEI,4BAAM,SAAS,CAAC,WAAhB,EAA6BgB,QAAQ,CAAChB,KAAtC,MAHR,cAIM,sCALF,EAJZ,CAxBY,CAmCZ,CACIS,KAAK,CAAE,mBADX,CAEIC,SAAS,CAAE,KAFf,CAGIG,GAAG,CAAE,KAHT,CAIIF,MAAM,CAAE,gBAAAhB,GAAG,qBACP,qDACI,oBAAC,KAAD,EACI,YAAY,CAAE,CADlB,CAEI,KAAK,CAAE,CAAEuB,KAAK,CAAE,KAAT,CAAgBC,WAAW,CAAE,MAA7B,CAFX,CAGI,QAAQ,CAAE,kBAACC,CAAD,QAAOrB,CAAAA,iBAAiB,CAACqB,CAAC,CAACC,MAAF,CAASrB,KAAV,CAAiBL,GAAjB,CAAsB,eAAtB,CAAxB,EAHd,CAII,IAAI,CAAC,QAJT,CAKI,QAAQ,CAAE,CAACpB,eAAe,CAAC+C,QAAhB,CAAyB3B,GAAzB,CALf,EADJ,cAUI,oBAAC,MAAD,EACI,aAAa,CAAE,CAAE4B,MAAM,CAAE,MAAV,CADnB,CAEI,KAAK,CAAE,CAAEL,KAAK,CAAE,KAAT,CAFX,CAGI,WAAW,CAAC,sBAHhB,CAII,QAAQ,CAAE,kBAAClB,KAAD,QAAWD,CAAAA,iBAAiB,CAACC,KAAD,CAAQL,GAAR,CAAa,cAAb,CAA5B,EAJd,CAKI,YAAY,CAAE,MACd;AANJ,CAOI,QAAQ,CAAE,CAACpB,eAAe,CAAC+C,QAAhB,CAAyB3B,GAAzB,CAPf,eAUI,oBAAC,MAAD,EAAQ,KAAK,CAAC,MAAd,SAVJ,cAWI,oBAAC,MAAD,EAAQ,KAAK,CAAC,SAAd,YAXJ,CAVJ,CADO,EAJf,CAnCY,CAAhB,CAqEA,GAAM6B,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpB,GAAIC,CAAAA,UAAU,CAAGrE,MAAM,CAACmC,UAAxB,CACAd,YAAY,CAACiD,GAAb,CAAiB,SAAAC,IAAI,CAAI,CACrB,GAAI5C,CAAAA,IAAI,CAAG,CACP0C,UAAU,CAAEA,UADL,CAEPG,SAAS,CAAED,IAAI,CAAChC,GAFT,CAGPK,KAAK,CAAE2B,IAAI,CAACrB,iBAHL,CAIPW,YAAY,CAAEU,IAAI,CAACpB,gBAJZ,CAAX,CAMAvD,KAAK,CAAC6E,KAAN,kCAA8C9C,IAA9C,EACKF,IADL,CACU,SAAAC,GAAG,CAAI,CACTtB,WAAW,CAACsB,GAAG,CAACC,IAAJ,CAAS+C,OAAV,CAAX,CACApE,WAAW,CAAC,SAAAqE,IAAI,QAAEA,CAAAA,IAAI,CAACtC,MAAL,CAAY,SAAAuC,IAAI,QAAEA,CAAAA,IAAI,CAACrC,GAAL,GAAab,GAAG,CAACC,IAAJ,CAAS+C,OAAT,CAAiBnC,GAAhC,EAAhB,CAAF,EAAL,CAAX,CACAjB,eAAe,CAAC,SAAAqD,IAAI,QAAEA,CAAAA,IAAI,CAACtC,MAAL,CAAY,SAAAuC,IAAI,QAAEA,CAAAA,IAAI,CAACrC,GAAL,GAAab,GAAG,CAACC,IAAJ,CAAS+C,OAAT,CAAiBnC,GAAhC,EAAhB,CAAF,EAAL,CAAf,CACAnB,kBAAkB,CAAC,SAAAuD,IAAI,QAAEA,CAAAA,IAAI,CAACtC,MAAL,CAAY,SAAAE,GAAG,QAAEA,CAAAA,GAAG,GAAKb,GAAG,CAACC,IAAJ,CAAS+C,OAAT,CAAiBnC,GAA3B,EAAf,CAAF,EAAL,CAAlB,CACH,CANL,EAOKX,KAPL,CAOW,SAAAC,GAAG,CAAI,CACVA,GAAG,EAAIA,GAAG,CAACI,QAAX,EAAuBH,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACI,QAAJ,CAAaN,IAAzB,CAAvB,CACH,CATL,EAUH,CAjBD,EAkBH,CApBD,CAqBA,mBACI,qDAUI,oBAAC,KAAD,EACI,MAAM,CAAE,IADZ,CAEI,KAAK,CAAC,aAFV,CAGI,OAAO,CAAE1B,cAHb,CAII,IAAI,CAAEC,QAJV,CAKI,QAAQ,CAAEC,YALd,CAMI,KAAK,CAAE,IANX,CAOI,KAAK,CAAE,CAAE0E,GAAG,CAAE,MAAP,CAPX,CAQI,SAAS,CAAE,CAAEC,QAAQ,CAAE,MAAZ,CAAoBC,MAAM,CAAE,MAA5B,CARf,CASI,MAAM,CAAE,cACJ,qDACI,oBAAC,MAAD,EAAQ,OAAO,CAAE,yBAAM5E,CAAAA,YAAY,EAAlB,EAAjB,CAAuC,SAAS,CAAC,YAAjD,CAA8D,IAAI,CAAC,SAAnE,CAA6E,MAAM,KAAnF,WADJ,CADI,CATZ,eAsBI,2BAAK,SAAS,CAAC,kBAAf,eAEI,oBAAC,MAAD,EAAQ,OAAO,CAAE,yBAAMiE,CAAAA,SAAS,EAAf,EAAjB,CAAoC,QAAQ,CAAE/C,YAAY,CAAC2D,MAAb,GAAwB,CAAtE,CAAyE,IAAI,CAAC,SAA9E,oBAFJ,CAGK3D,YAAY,CAAC2D,MAAb,CAAsB,CAAtB,eAA2B,8BAAQ,KAAK,CAAE,CAAEC,UAAU,CAAE,MAAd,CAAf,EAAwC5D,YAAY,CAAC2D,MAArD,qBAHhC,cAII,oBAAC,KAAD,EACI,YAAY,CAAEvC,YADlB,CAEI,OAAO,CAAEW,OAFb,CAGI,UAAU,CAAE/C,QAHhB,CAII,MAAM,CAAC,KAJX,EAJJ,CAtBJ,CAVJ,CADJ,CAiDH,CAED,cAAeN,CAAAA,SAAf","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Select, Col, Card, Input, Button, Table, Tag, Space, Image, Switch, Popconfirm, Modal, DatePicker } from 'antd';\nimport axios from 'axios'\nimport { useParams } from 'react-router-dom';\nconst { Option } = Select;\n\n\n\nfunction AddToCamp({params,isModalVisible,handleOk,handleCancel,sendProduct}) {\n    \n    \n    const [products, setProducts] = useState([])\n\n\n    const [categories, setCategories] = useState([])\n    const [subCategories, setSubCategories] = useState([])\n    const [category, setCategory] = useState('')\n    const [subCategory, setSubCategory] = useState('')\n    const [brands, setBrands] = useState([])\n    const [brand, setBrand] = useState('')\n    const [selectedRowKeys, setSelectedRowKeys] = useState([])\n    const [selectedRows, setSelectedRows] = useState([])\n\n    const fetchCategories = () => {\n        axios.get(\"/category/getcategory\")\n            .then(res => {\n                setCategories(res.data.categories)\n            })\n            .catch(err => {\n                console.log(err);\n            })\n    }\n\n    const fetchBrands = () => {\n        axios.get('/brand/get')\n            .then(res => {\n                // console.log(res.data.brands);\n                setBrands(res.data.brands)\n            })\n            .catch(err => {\n                err && err.response && console.log(err.response.data)\n            })\n    }\n\n    const fetchProducts = () => {\n        axios.get('/campaign/getproductstoselect/'+params.campaignid)\n            .then(res => {\n                setProducts(res.data.products)\n            })\n            .catch(err => {\n                err && err.response && console.log(err.response.data)\n            })\n    }\n\n\n    useEffect(() => {\n        //fetchCategories()\n        //fetchBrands()\n        fetchProducts()\n    }, [isModalVisible])\n\n    //category actions\n    useEffect(() => {\n        if (category) {\n            let filterd = categories.filter(cat => cat._id === category)\n            setSubCategories(filterd[0]?.children)\n            setSubCategory('')\n\n        } else {\n            setSubCategories([])\n            setSubCategory('')\n\n        }\n    }, [category])\n\n\n\n\n    const rowSelection = {\n        selectedRowKeys,\n        onChange: (selectedRowKeys, selectedRows) => {\n\n            setSelectedRowKeys(selectedRowKeys);\n            setSelectedRows(selectedRows)\n        },\n    };\n\n\n\n\n\n    const handleColumnValue = (value, _id, type) => {\n\n        if (type === 'discountvalue') {\n            let selected = [...selectedRows]\n            let index = selected.findIndex(r => r._id === _id)\n            selected[index] = { ...selected[index], campDiscountValue: value }\n            setSelectedRows(selected)\n        }\n        if (type === 'discounttype') {\n            let selected = [...selectedRows]\n            let index = selected.findIndex(r => r._id === _id)\n            selected[index] = { ...selected[index], campDiscountType: value }\n            setSelectedRows(selected)\n        }\n    }\n\n   // console.log(selectedRows);\n\n\n\n    const columns = [\n        {\n            title: 'Name',\n            dataIndex: 'name',\n            render: (text) => <a>{text}</a>,\n        },\n        {\n            title: 'Thumbnail',\n            key: 'thumbnail',\n            dataIndex: 'thumbnail',\n            render: thumbnail => <Image\n                width={30}\n                src={thumbnail}\n                fallback=\"data:image/png;base64,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\"\n            />\n        },\n        {\n            title: 'price',\n            dataIndex: 'price',\n            key: 'price',\n            render: price =>\n                <span>$ {price}</span>\n\n        },\n        {\n            title: 'Previous Discount',\n            key: 'discount',\n            dataIndex: 'discount',\n            render: (discount) =>\n                discount.value > 0 ?\n                    discount.discountType === 'flat' ?\n                        <span className=\"new-price\">$ {discount.value}</span> :\n                        <span className=\"new-price\">{discount.value} %</span>\n                    : <span>$ 0</span>\n        },\n        {\n            title: 'Campaign Discount',\n            dataIndex: '_id',\n            key: '_id',\n            render: _id =>\n                <>\n                    <Input\n                        defaultValue={0}\n                        style={{ width: \"50%\", marginRight: \"10px\" }}\n                        onChange={(e) => handleColumnValue(e.target.value, _id, \"discountvalue\")}\n                        type='number'\n                        disabled={!selectedRowKeys.includes(_id)}\n                    >\n\n                    </Input>\n                    <Select\n                        dropdownStyle={{ zIndex: \"1111\" }}\n                        style={{ width: \"45%\" }}\n                        placeholder=\"Select discount type\"\n                        onChange={(value) => handleColumnValue(value, _id, \"discounttype\")}\n                        defaultValue={'flat'}\n                        //value={discountType}\n                        disabled={!selectedRowKeys.includes(_id)}\n\n                    >\n                        <Option value=\"flat\">Flat</Option>\n                        <Option value=\"percent\">Percent</Option>\n                    </Select>\n                </>\n\n        },\n    ];\n\n\n    const addToCamp = () => {\n        let campaignId = params.campaignid\n        selectedRows.map(rows => {\n            let data = {\n                campaignId: campaignId,\n                productId: rows._id,\n                value: rows.campDiscountValue,\n                discountType: rows.campDiscountType\n            }\n            axios.patch(`/campaign/addproducttocampaign`, data)\n                .then(res => {\n                    sendProduct(res.data.product)\n                    setProducts(prev=>prev.filter(prod=>prod._id !== res.data.product._id))\n                    setSelectedRows(prev=>prev.filter(prod=>prod._id !== res.data.product._id))\n                    setSelectedRowKeys(prev=>prev.filter(_id=>_id !== res.data.product._id))\n                })\n                .catch(err => {\n                    err && err.response && console.log(err.response.data)\n                })\n        })\n    }\n    return (\n        <>\n            \n\n\n\n\n\n\n\n\n            <Modal\n                zIndex={1111}\n                title=\"Basic Modal\"\n                visible={isModalVisible}\n                onOk={handleOk}\n                onCancel={handleCancel}\n                width={1000}\n                style={{ top: \"10px\" }}\n                bodyStyle={{ overflow: \"auto\", height: \"80vh\" }}\n                footer={[\n                    <>\n                        <Button onClick={() => handleCancel()} className='submit_btn' type=\"primary\" danger>Cancel</Button>\n                        {/* {\n                            editCamp ?\n                                <Button  onClick={() => updateCamp()} className='submit_btn' type=\"primary\">Update</Button> :\n                                <Button loading={isLoading} onClick={() => createCamp()} className='submit_btn' type=\"primary\">Create</Button>\n                        } */}\n\n                    </>\n                ]}\n            >\n\n                <div className='campaign_wrapper'>\n\n                    <Button onClick={() => addToCamp()} disabled={selectedRows.length === 0} type='primary'>Add to campaign</Button>\n                    {selectedRows.length > 0 && <strong style={{ marginLeft: \"10px\" }}>{selectedRows.length} products seleted</strong>}\n                    <Table\n                        rowSelection={rowSelection}\n                        columns={columns}\n                        dataSource={products}\n                        rowKey=\"_id\"\n\n                    />\n                </div>\n\n            </Modal>\n        </>\n    )\n}\n\nexport default AddToCamp\n"]},"metadata":{},"sourceType":"module"}