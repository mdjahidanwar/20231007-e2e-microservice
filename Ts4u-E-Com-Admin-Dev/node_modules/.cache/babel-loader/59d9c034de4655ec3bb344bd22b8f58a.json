{"ast":null,"code":"var _jsxFileName = \"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/withAuth/withAuth.js\";\nimport React, { Component } from \"react\";\nimport { Spin } from 'antd';\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nimport store from \"../store/index\";\n\nconst configureAxiosHeader = () => {\n  axios.defaults.baseURL = process.env.REACT_APP_API;\n  const token = Cookies.get(\"ecom\");\n  axios.defaults.headers.common = {\n    Authorization: token\n  };\n};\n\nconst withAuth = AuthComponent => {\n  return class Authenticated extends Component {\n    constructor(props) {\n      super(props);\n      this.state = {\n        isLoading: true,\n        userData: []\n      };\n    }\n\n    componentDidMount() {\n      configureAxiosHeader();\n      const token = Cookies.get(\"ecom\");\n\n      if (token) {\n        this.setState({\n          isLoading: true\n        });\n        axios.post(`${process.env.REACT_APP_API}/user/verify`, {}).then(res => {\n          if (res.status === 200 && res.data.success) {\n            //do some change state\n            this.setState({\n              userData: res.data.user\n            });\n            this.setState({\n              isLoading: false\n            });\n            store.dispatch({\n              type: \"SET_USER\",\n              payload: res.data.user\n            });\n          }\n        }).catch(err => {\n          this.setState({\n            isLoading: false\n          });\n          Cookies.remove(\"ecom\");\n          console.log(err.message);\n          store.dispatch({\n            type: \"LOGOUT\"\n          });\n\n          if (window.location.pathname !== '/login') {\n            window.location.pathname = '/login';\n          }\n        });\n      } else {\n        this.setState({\n          isLoading: false\n        });\n\n        if (window.location.pathname !== '/login') {\n          if (window.location.pathname === '/register') {\n            return;\n          } else {\n            window.location.pathname = '/login';\n          }\n        }\n      }\n    }\n\n    render() {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 9\n        }\n      }, this.state.isLoading ? /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          height: \"100vh\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\"\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Spin, {\n        size: 'large',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 102\n        }\n      })) : /*#__PURE__*/React.createElement(AuthComponent, Object.assign({}, this.props, {\n        userData: this.state.userData,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 13\n        }\n      })));\n    }\n\n  };\n};\n\nexport default withAuth;","map":{"version":3,"sources":["/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/withAuth/withAuth.js"],"names":["React","Component","Spin","Cookies","axios","store","configureAxiosHeader","defaults","baseURL","process","env","REACT_APP_API","token","get","headers","common","Authorization","withAuth","AuthComponent","Authenticated","constructor","props","state","isLoading","userData","componentDidMount","setState","post","then","res","status","data","success","user","dispatch","type","payload","catch","err","remove","console","log","message","window","location","pathname","render","height","display","justifyContent","alignItems"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Spin } from 'antd';\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\n\nimport store from \"../store/index\";\n\nconst configureAxiosHeader = () => {\n    axios.defaults.baseURL = process.env.REACT_APP_API\n  const token = Cookies.get(\"ecom\");\n  axios.defaults.headers.common = {\n    Authorization: token,\n  };\n};\n\nconst withAuth = (AuthComponent) => {\n  return class Authenticated extends Component {\n\n    constructor(props) {\n      super(props);\n      this.state = {\n        isLoading: true,\n        userData: [],\n      };\n    }\n\n    componentDidMount() {\n     \n      configureAxiosHeader();\n      const token = Cookies.get(\"ecom\");\n      if(token){\n\n        this.setState({ isLoading: true });\n        axios\n          .post(`${process.env.REACT_APP_API}/user/verify`, {})\n          .then((res) => {\n            if (res.status === 200 && res.data.success) {\n              //do some change state\n              this.setState({ userData: res.data.user });\n              this.setState({ isLoading: false });\n              store.dispatch({\n                  type:\"SET_USER\",\n                  payload:res.data.user\n              })\n            }\n          })\n          .catch((err) => {\n              this.setState({ isLoading: false });\n            Cookies.remove(\"ecom\");\n            console.log(err.message);\n            store.dispatch({\n                type:\"LOGOUT\"\n            })\n            if(window.location.pathname !== '/login'){\n             \n                window.location.pathname='/login'\n\n            }\n            \n          });\n      }else{\n        this.setState({ isLoading: false });\n  \n        if(window.location.pathname !== '/login'){\n            if(window.location.pathname === '/register'){\n             return\n            }else{\n              window.location.pathname='/login'\n            }\n         \n        }\n      }\n     \n    }\n\n    render() {\n      return (\n        <div>\n          {this.state.isLoading ? (\n            <div style={{height:\"100vh\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\"}}><Spin size={'large'}/></div>\n          ) : (\n            <AuthComponent {...this.props} userData={this.state.userData} />\n          )}\n        </div>\n      );\n    }\n  };\n};\nexport default withAuth;\n"]},"metadata":{},"sourceType":"module"}