{"ast":null,"code":"import _regeneratorRuntime from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React from'react';import{FileLibraryListItem,ReactMediaLibrary,FileMeta}from'react-media-library';import{useSelector,useDispatch}from'react-redux';import'./media.scss';import{dataURIToBlob,resizeFile}from'../components/imageResize';import axios from'axios';function MediaLibrary(_ref){var display=_ref.display,onHide=_ref.onHide,selectCallback=_ref.selectCallback;var _useSelector=useSelector(function(state){return state.media;}),media=_useSelector.media;var dispatch=useDispatch();function uploadCallback(_x,_x2){return _uploadCallback.apply(this,arguments);}function _uploadCallback(){_uploadCallback=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(fileBase64,fileMeta){var imageConverted,formData,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return resizeFile(dataURIToBlob(fileBase64));case 2:imageConverted=_context.sent;formData=new FormData();formData.append(\"media\",dataURIToBlob(imageConverted),fileMeta.fileName);_context.next=7;return axios.post('/media/upload',formData);case 7:res=_context.sent;if(!(res.status===200)){_context.next=13;break;}dispatch({type:\"ADD_MEDIA\",payload:res.data.data});return _context.abrupt(\"return\",true);case 13:return _context.abrupt(\"return\",false);case 14:case\"end\":return _context.stop();}}},_callee);}));return _uploadCallback.apply(this,arguments);}function deleteCallback(_x3){return _deleteCallback.apply(this,arguments);}function _deleteCallback(){_deleteCallback=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(item){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.delete(\"/media/delete/\".concat(item._id));case 2:res=_context2.sent;if(res.data.success){dispatch({type:\"UPDATE_MEDIA\",payload:item._id});}// Delete the data from your database\n// Also remember to update the fileLibraryList prop with a new list\ncase 4:case\"end\":return _context2.stop();}}},_callee2);}));return _deleteCallback.apply(this,arguments);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ReactMediaLibrary,{show:display,onHide:onHide,fileUploadCallback:uploadCallback,fileLibraryList:media,fileSelectCallback:selectCallback,fileDeleteCallback:deleteCallback}));}export default MediaLibrary;","map":{"version":3,"sources":["/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/components/MediaLibrary.js"],"names":["React","FileLibraryListItem","ReactMediaLibrary","FileMeta","useSelector","useDispatch","dataURIToBlob","resizeFile","axios","MediaLibrary","display","onHide","selectCallback","state","media","dispatch","uploadCallback","fileBase64","fileMeta","imageConverted","formData","FormData","append","fileName","post","res","status","type","payload","data","deleteCallback","item","delete","_id","success"],"mappings":"6XAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,mBAAT,CAA8BC,iBAA9B,CAAiDC,QAAjD,KAAiE,qBAAjE,CACA,OAASC,WAAT,CAAqBC,WAArB,KAAwC,aAAxC,CACA,MAAO,cAAP,CACA,OAASC,aAAT,CAAwBC,UAAxB,KAA0C,2BAA1C,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAGA,QAASC,CAAAA,YAAT,MAA2D,IAAnCC,CAAAA,OAAmC,MAAnCA,OAAmC,CAA1BC,MAA0B,MAA1BA,MAA0B,CAAlBC,cAAkB,MAAlBA,cAAkB,CAEvD,iBAAkBR,WAAW,CAAC,SAAAS,KAAK,QAAIA,CAAAA,KAAK,CAACC,KAAV,EAAN,CAA7B,CAAQA,KAAR,cAAQA,KAAR,CACA,GAAMC,CAAAA,QAAQ,CAAGV,WAAW,EAA5B,CAHuD,QAKxCW,CAAAA,cALwC,0JAKvD,iBAA8BC,UAA9B,CAA0CC,QAA1C,wKAGiCX,CAAAA,UAAU,CAAED,aAAa,CAACW,UAAD,CAAf,CAH3C,QAGUE,cAHV,eAMQC,QANR,CAMmB,GAAIC,CAAAA,QAAJ,EANnB,CAOID,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBhB,aAAa,CAACa,cAAD,CAAtC,CAAuDD,QAAQ,CAACK,QAAhE,EAPJ,sBASoBf,CAAAA,KAAK,CAACgB,IAAN,CAAW,eAAX,CAA2BJ,QAA3B,CATpB,QASQK,GATR,oBAUOA,GAAG,CAACC,MAAJ,GAAa,GAVpB,2BAWQX,QAAQ,CAAC,CACLY,IAAI,CAAC,WADA,CAELC,OAAO,CAACH,GAAG,CAACI,IAAJ,CAASA,IAFZ,CAAD,CAAR,CAXR,gCAee,IAff,0CAiBe,KAjBf,yDALuD,yDA4BxCC,CAAAA,cA5BwC,uJA4BvD,kBAA8BC,IAA9B,qJAGoBvB,CAAAA,KAAK,CAACwB,MAAN,yBAA8BD,IAAI,CAACE,GAAnC,EAHpB,QAGQR,GAHR,gBAII,GAAGA,GAAG,CAACI,IAAJ,CAASK,OAAZ,CAAoB,CAChBnB,QAAQ,CAAC,CACLY,IAAI,CAAC,cADA,CAELC,OAAO,CAACG,IAAI,CAACE,GAFR,CAAD,CAAR,CAIH,CACD;AACA;AAXJ,wDA5BuD,iDA0CvD,mBACQ,qDACI,oBAAC,iBAAD,EAEI,IAAI,CAAEvB,OAFV,CAGI,MAAM,CAAEC,MAHZ,CAII,kBAAkB,CAAEK,cAJxB,CAKI,eAAe,CAAEF,KALrB,CAMI,kBAAkB,CAAEF,cANxB,CAOI,kBAAkB,CAAEkB,cAPxB,EADJ,CADR,CAaC,CAED,cAAerB,CAAAA,YAAf","sourcesContent":["import React from 'react'\nimport { FileLibraryListItem, ReactMediaLibrary, FileMeta } from 'react-media-library';\nimport { useSelector,useDispatch } from 'react-redux'\nimport './media.scss'\nimport { dataURIToBlob, resizeFile } from '../components/imageResize'\nimport axios from 'axios'\n\n\nfunction MediaLibrary({ display, onHide, selectCallback }) {\n\n    const { media } = useSelector(state => state.media)\n    const dispatch = useDispatch()\n\n    async function uploadCallback(fileBase64, fileMeta) {\n        // TODO Upload file to backend APIs\n        \n        const imageConverted = await resizeFile( dataURIToBlob(fileBase64));\n       \n       \n        let formData = new FormData();\n        formData.append(\"media\", dataURIToBlob(imageConverted),fileMeta.fileName);\n\n        let res = await axios.post('/media/upload',formData)\n        if(res.status===200){\n            dispatch({\n                type:\"ADD_MEDIA\",\n                payload:res.data.data\n            })\n            return true;\n        }else{\n            return false;\n        }\n\n    }\n\n\n    async function deleteCallback(item) {\n       // console.log(item);\n\n        let res = await axios.delete(`/media/delete/${item._id}`)\n        if(res.data.success){\n            dispatch({\n                type:\"UPDATE_MEDIA\",\n                payload:item._id\n            })\n        }\n        // Delete the data from your database\n        // Also remember to update the fileLibraryList prop with a new list\n    }\n\n    return (\n            <>\n                <ReactMediaLibrary\n\n                    show={display}\n                    onHide={onHide}\n                    fileUploadCallback={uploadCallback}\n                    fileLibraryList={media}\n                    fileSelectCallback={selectCallback}\n                    fileDeleteCallback={deleteCallback}\n                />\n            </>\n        )\n    }\n\n    export default MediaLibrary\n"]},"metadata":{},"sourceType":"module"}