{"ast":null,"code":"var _jsxFileName = \"/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/pages/campaigns/Campaign.js\";\nimport React, { useState, useEffect } from 'react';\nimport { Select, Col, Card, Input, Button, Table, Tag, Space, Image, Switch, Popconfirm, Modal, DatePicker } from 'antd';\nimport axios from 'axios';\nimport { useParams } from 'react-router-dom';\nimport AddToCamp from './AddToCamp';\nconst {\n  Option\n} = Select;\n\nfunction Campaign() {\n  let params = useParams();\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [products, setProducts] = useState([]);\n  const [selectedRowKeys, setSelectedRowKeys] = useState([]);\n  const [selectedRows, setSelectedRows] = useState([]);\n  const [categories, setCategories] = useState([]);\n  const [subCategories, setSubCategories] = useState([]);\n  const [category, setCategory] = useState('');\n  const [subCategory, setSubCategory] = useState('');\n  const [brands, setBrands] = useState([]);\n  const [brand, setBrand] = useState('');\n\n  const fetchCategories = () => {\n    axios.get(\"/category/getcategory\").then(res => {\n      setCategories(res.data.categories);\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n\n  const fetchBrands = () => {\n    axios.get('/brand/get').then(res => {\n      // console.log(res.data.brands);\n      setBrands(res.data.brands);\n    }).catch(err => {\n      err && err.response && console.log(err.response.data);\n    });\n  };\n\n  const fetchProducts = () => {\n    axios.get('/campaign/getselectedproduct/' + params.campaignid).then(res => {\n      setProducts(res.data.products);\n    }).catch(err => {\n      err && err.response && console.log(err.response.data);\n    });\n  };\n\n  useEffect(() => {\n    fetchCategories();\n    fetchBrands();\n    fetchProducts();\n  }, []); //category actions\n\n  useEffect(() => {\n    if (category) {\n      var _filterd$;\n\n      let filterd = categories.filter(cat => cat._id === category);\n      setSubCategories((_filterd$ = filterd[0]) === null || _filterd$ === void 0 ? void 0 : _filterd$.children);\n      setSubCategory('');\n    } else {\n      setSubCategories([]);\n      setSubCategory('');\n    }\n  }, [category]);\n\n  const showModal = () => {\n    setIsModalVisible(true);\n  };\n\n  const handleOk = () => {\n    setIsModalVisible(false);\n  };\n\n  const handleCancel = () => {\n    setIsModalVisible(false);\n  };\n\n  const getValueDiscount = _id => {\n    // console.log(_id);\n    let campaigns = products.filter(prod => prod._id === _id)[0].campaigns;\n    let discount = campaigns.filter(camp => camp.campaign === params.campaignid)[0].discount;\n    return discount;\n  };\n\n  const columns = [{\n    title: 'Name',\n    dataIndex: 'name',\n    render: text => /*#__PURE__*/React.createElement(\"a\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 31\n      }\n    }, text)\n  }, {\n    title: 'Thumbnail',\n    key: 'thumbnail',\n    dataIndex: 'thumbnail',\n    render: thumbnail => /*#__PURE__*/React.createElement(Image, {\n      width: 30,\n      src: thumbnail,\n      fallback: \"data:image/png;base64,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\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 34\n      }\n    })\n  }, {\n    title: 'price',\n    dataIndex: 'price',\n    key: 'price',\n    render: price => /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }\n    }, \"$ \", price)\n  }, {\n    title: 'Previous Discount',\n    key: 'discount',\n    dataIndex: 'discount',\n    render: discount => discount.value > 0 ? discount.discountType === 'flat' ? /*#__PURE__*/React.createElement(\"span\", {\n      className: \"new-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 25\n      }\n    }, \"$ \", discount.value) : /*#__PURE__*/React.createElement(\"span\", {\n      className: \"new-price\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 25\n      }\n    }, discount.value, \" %\") : /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 23\n      }\n    }, \"$ 0\")\n  }, {\n    title: 'Campaign Discount',\n    dataIndex: '_id',\n    key: '_id',\n    render: _id => /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Input, {\n      defaultValue: getValueDiscount(_id).value,\n      style: {\n        width: \"50%\",\n        marginRight: \"10px\"\n      },\n      onChange: e => handleColumnValue(e.target.value, _id, \"discountvalue\"),\n      type: \"number\",\n      disabled: !selectedRowKeys.includes(_id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Select, {\n      dropdownStyle: {\n        zIndex: \"1111\"\n      },\n      style: {\n        width: \"45%\"\n      },\n      placeholder: \"Select discount type\",\n      onChange: value => handleColumnValue(value, _id, \"discounttype\"),\n      defaultValue: getValueDiscount(_id).discountType //value={discountType}\n      ,\n      disabled: !selectedRowKeys.includes(_id),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Option, {\n      value: \"flat\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 25\n      }\n    }, \"Flat\"), /*#__PURE__*/React.createElement(Option, {\n      value: \"percent\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 25\n      }\n    }, \"Percent\")))\n  }];\n\n  const handleColumnValue = (value, _id, type) => {\n    if (type === 'discountvalue') {\n      let selected = [...selectedRows];\n      let index = selected.findIndex(r => r._id === _id);\n      selected[index] = { ...selected[index],\n        campDiscountValue: value\n      };\n      setSelectedRows(selected);\n    }\n\n    if (type === 'discounttype') {\n      let selected = [...selectedRows];\n      let index = selected.findIndex(r => r._id === _id);\n      selected[index] = { ...selected[index],\n        campDiscountType: value\n      };\n      setSelectedRows(selected);\n    }\n  };\n\n  const rowSelection = {\n    selectedRowKeys,\n    onChange: (selectedRowKeys, selectedRows) => {\n      setSelectedRowKeys(selectedRowKeys);\n      setSelectedRows(selectedRows);\n    }\n  };\n\n  const updateToCamp = () => {\n    let campaignId = params.campaignid;\n    selectedRows.map(rows => {\n      let data = {\n        campaignId: campaignId,\n        productId: rows._id,\n        value: rows.campDiscountValue,\n        discountType: rows.campDiscountType\n      };\n      axios.patch(`/campaign/updateproducttocampaign`, data).then(res => {\n        let array = [...products];\n        let index = array.findIndex(a => a._id === res.data.product._id);\n        array[index] = res.data.product;\n        setProducts(array);\n        setSelectedRows(prev => prev.filter(prod => prod._id !== res.data.product._id));\n        setSelectedRowKeys(prev => prev.filter(_id => _id !== res.data.product._id));\n      }).catch(err => {\n        err && err.response && console.log(err.response.data);\n      });\n    });\n  };\n\n  const removeFromCamp = () => {\n    let campaignId = params.campaignid;\n    selectedRows.map(rows => {\n      let data = {\n        campaignId: campaignId,\n        productId: rows._id\n      };\n      axios.patch(`/campaign/removeproductfromcampaign`, data).then(res => {\n        setProducts(prev => prev.filter(prod => prod._id !== res.data.product._id));\n        setSelectedRows(prev => prev.filter(prod => prod._id !== res.data.product._id));\n        setSelectedRowKeys(prev => prev.filter(_id => _id !== res.data.product._id));\n      }).catch(err => {\n        err && err.response && console.log(err.response.data);\n      });\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"campaign\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    onClick: () => showModal(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }\n  }, \"Add products\"), /*#__PURE__*/React.createElement(Card, {\n    style: {\n      marginTop: \"15px\"\n    },\n    title: \"Products\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"campaign_wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    style: {\n      marginRight: \"10px\"\n    },\n    onClick: () => updateToCamp(),\n    disabled: selectedRows.length === 0,\n    type: \"primary\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 21\n    }\n  }, \"Update Products\"), /*#__PURE__*/React.createElement(Button, {\n    onClick: () => removeFromCamp(),\n    disabled: selectedRows.length === 0,\n    type: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }\n  }, \"Remove Products\"), selectedRows.length > 0 && /*#__PURE__*/React.createElement(\"strong\", {\n    style: {\n      marginLeft: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 49\n    }\n  }, selectedRows.length, \" products seleted\"), /*#__PURE__*/React.createElement(Table, {\n    rowSelection: rowSelection,\n    columns: columns,\n    dataSource: products,\n    rowKey: \"_id\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 21\n    }\n  }))), /*#__PURE__*/React.createElement(AddToCamp, {\n    isModalVisible: isModalVisible,\n    handleCancel: handleCancel,\n    handleOk: handleOk,\n    params: params,\n    sendProduct: prod => setProducts(prev => [prod, ...prev]),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 13\n    }\n  }));\n}\n\nexport default Campaign;","map":{"version":3,"sources":["/home/e2e/e2e-microservice/20231007-e2e-microservice/Ts4u-E-Com-Admin-Dev/src/pages/campaigns/Campaign.js"],"names":["React","useState","useEffect","Select","Col","Card","Input","Button","Table","Tag","Space","Image","Switch","Popconfirm","Modal","DatePicker","axios","useParams","AddToCamp","Option","Campaign","params","isModalVisible","setIsModalVisible","products","setProducts","selectedRowKeys","setSelectedRowKeys","selectedRows","setSelectedRows","categories","setCategories","subCategories","setSubCategories","category","setCategory","subCategory","setSubCategory","brands","setBrands","brand","setBrand","fetchCategories","get","then","res","data","catch","err","console","log","fetchBrands","response","fetchProducts","campaignid","filterd","filter","cat","_id","children","showModal","handleOk","handleCancel","getValueDiscount","campaigns","prod","discount","camp","campaign","columns","title","dataIndex","render","text","key","thumbnail","price","value","discountType","width","marginRight","e","handleColumnValue","target","includes","zIndex","type","selected","index","findIndex","r","campDiscountValue","campDiscountType","rowSelection","onChange","updateToCamp","campaignId","map","rows","productId","patch","array","a","product","prev","removeFromCamp","marginTop","length","marginLeft"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { Select, Col, Card, Input, Button, Table, Tag, Space, Image, Switch, Popconfirm, Modal, DatePicker } from 'antd';\nimport axios from 'axios'\nimport { useParams } from 'react-router-dom';\nimport AddToCamp from './AddToCamp';\nconst { Option } = Select;\n\n\n\nfunction Campaign() {\n    let params = useParams()\n    const [isModalVisible, setIsModalVisible] = useState(false);\n    const [products, setProducts] = useState([])\n\n    const [selectedRowKeys, setSelectedRowKeys] = useState([])\n    const [selectedRows, setSelectedRows] = useState([])\n\n\n    const [categories, setCategories] = useState([])\n    const [subCategories, setSubCategories] = useState([])\n    const [category, setCategory] = useState('')\n    const [subCategory, setSubCategory] = useState('')\n    const [brands, setBrands] = useState([])\n    const [brand, setBrand] = useState('')\n\n    const fetchCategories = () => {\n        axios.get(\"/category/getcategory\")\n            .then(res => {\n                setCategories(res.data.categories)\n            })\n            .catch(err => {\n                console.log(err);\n            })\n    }\n\n    const fetchBrands = () => {\n        axios.get('/brand/get')\n            .then(res => {\n                // console.log(res.data.brands);\n                setBrands(res.data.brands)\n            })\n            .catch(err => {\n                err && err.response && console.log(err.response.data)\n            })\n    }\n\n    const fetchProducts = () => {\n        axios.get('/campaign/getselectedproduct/' + params.campaignid)\n            .then(res => {\n                setProducts(res.data.products)\n            })\n            .catch(err => {\n                err && err.response && console.log(err.response.data)\n            })\n    }\n\n\n    useEffect(() => {\n        fetchCategories()\n        fetchBrands()\n        fetchProducts()\n    }, [])\n\n    //category actions\n    useEffect(() => {\n        if (category) {\n            let filterd = categories.filter(cat => cat._id === category)\n            setSubCategories(filterd[0]?.children)\n            setSubCategory('')\n\n        } else {\n            setSubCategories([])\n            setSubCategory('')\n\n        }\n    }, [category])\n\n\n    const showModal = () => {\n        setIsModalVisible(true);\n    };\n\n    const handleOk = () => {\n        setIsModalVisible(false);\n    };\n\n    const handleCancel = () => {\n        setIsModalVisible(false);\n    };\n\n\n\n    const getValueDiscount = (_id) => {\n        // console.log(_id);\n        let campaigns = products.filter(prod => prod._id === _id)[0].campaigns\n\n        let discount = campaigns.filter(camp => camp.campaign === params.campaignid)[0].discount\n        return discount\n\n    }\n    const columns = [\n        {\n            title: 'Name',\n            dataIndex: 'name',\n            render: (text) => <a>{text}</a>,\n        },\n        {\n            title: 'Thumbnail',\n            key: 'thumbnail',\n            dataIndex: 'thumbnail',\n            render: thumbnail => <Image\n                width={30}\n                src={thumbnail}\n                fallback=\"data:image/png;base64,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\"\n            />\n        },\n        {\n            title: 'price',\n            dataIndex: 'price',\n            key: 'price',\n            render: price =>\n                <span>$ {price}</span>\n\n        },\n        {\n            title: 'Previous Discount',\n            key: 'discount',\n            dataIndex: 'discount',\n            render: (discount) =>\n                discount.value > 0 ?\n                    discount.discountType === 'flat' ?\n                        <span className=\"new-price\">$ {discount.value}</span> :\n                        <span className=\"new-price\">{discount.value} %</span>\n                    : <span>$ 0</span>\n        },\n        {\n            title: 'Campaign Discount',\n            dataIndex: '_id',\n            key: '_id',\n            render: _id =>\n                <>\n                    <Input\n                        defaultValue={getValueDiscount(_id).value}\n                        style={{ width: \"50%\", marginRight: \"10px\" }}\n                        onChange={(e) => handleColumnValue(e.target.value, _id, \"discountvalue\")}\n                        type='number'\n                        disabled={!selectedRowKeys.includes(_id)}\n\n                    >\n\n                    </Input>\n                    <Select\n                        dropdownStyle={{ zIndex: \"1111\" }}\n                        style={{ width: \"45%\" }}\n                        placeholder=\"Select discount type\"\n                        onChange={(value) => handleColumnValue(value, _id, \"discounttype\")}\n                        defaultValue={getValueDiscount(_id).discountType}\n                        //value={discountType}\n                        disabled={!selectedRowKeys.includes(_id)}\n\n                    >\n                        <Option value=\"flat\">Flat</Option>\n                        <Option value=\"percent\">Percent</Option>\n                    </Select>\n                </>\n\n        },\n    ];\n\n\n\n    const handleColumnValue = (value, _id, type) => {\n\n        if (type === 'discountvalue') {\n            let selected = [...selectedRows]\n            let index = selected.findIndex(r => r._id === _id)\n            selected[index] = { ...selected[index], campDiscountValue: value }\n            setSelectedRows(selected)\n        }\n        if (type === 'discounttype') {\n            let selected = [...selectedRows]\n            let index = selected.findIndex(r => r._id === _id)\n            selected[index] = { ...selected[index], campDiscountType: value }\n            setSelectedRows(selected)\n        }\n    }\n\n\n    const rowSelection = {\n        selectedRowKeys,\n        onChange: (selectedRowKeys, selectedRows) => {\n\n            setSelectedRowKeys(selectedRowKeys);\n            setSelectedRows(selectedRows)\n        },\n    };\n\n\n\n    const updateToCamp = () => {\n        let campaignId = params.campaignid\n        selectedRows.map(rows => {\n            let data = {\n                campaignId: campaignId,\n                productId: rows._id,\n                value: rows.campDiscountValue,\n                discountType: rows.campDiscountType\n            }\n            axios.patch(`/campaign/updateproducttocampaign`, data)\n                .then(res => {\n                    let array = [...products]\n                    let index = array.findIndex(a=>a._id === res.data.product._id)\n                    array[index] = res.data.product\n                    setProducts(array)\n                    setSelectedRows(prev => prev.filter(prod => prod._id !== res.data.product._id))\n                    setSelectedRowKeys(prev => prev.filter(_id => _id !== res.data.product._id))\n                })\n                .catch(err => {\n                    err && err.response && console.log(err.response.data)\n                })\n        })\n    }\n\n\n    const removeFromCamp = () => {\n        let campaignId = params.campaignid\n        selectedRows.map(rows => {\n            let data = {\n                campaignId: campaignId,\n                productId: rows._id,\n            }\n            axios.patch(`/campaign/removeproductfromcampaign`, data)\n                .then(res => {\n                    setProducts(prev=>prev.filter(prod => prod._id !== res.data.product._id))\n                    setSelectedRows(prev => prev.filter(prod => prod._id !== res.data.product._id))\n                    setSelectedRowKeys(prev => prev.filter(_id => _id !== res.data.product._id))\n                })\n                .catch(err => {\n                    err && err.response && console.log(err.response.data)\n                })\n        })\n    }\n\n    return (\n        <div className='campaign'>\n            <Button onClick={() => showModal()}>Add products</Button>\n            <Card style={{ marginTop: \"15px\" }} title=\"Products\" >\n                <div className='campaign_wrapper'>\n\n                    <Button style={{marginRight:\"10px\"}} onClick={() => updateToCamp()} disabled={selectedRows.length === 0} type='primary'>Update Products</Button>\n                    <Button onClick={() => removeFromCamp()} disabled={selectedRows.length === 0} type='danger'>Remove Products</Button>\n                    {selectedRows.length > 0 && <strong style={{ marginLeft: \"10px\" }}>{selectedRows.length} products seleted</strong>}\n                    <Table\n                        rowSelection={rowSelection}\n                        columns={columns}\n                        dataSource={products}\n                        rowKey=\"_id\"\n\n                    />\n                </div>\n            </Card>\n            <AddToCamp\n                isModalVisible={isModalVisible}\n                handleCancel={handleCancel}\n                handleOk={handleOk}\n                params={params}\n                sendProduct={(prod)=>setProducts(prev=>[prod,...prev])}\n            />\n\n        </div>\n    )\n}\n\nexport default Campaign\n"]},"metadata":{},"sourceType":"module"}